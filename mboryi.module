<?php

/** 
 * Implements hook_permission().
 */ 
function mboryi_permission() {
  return array();
  /*
  return array(
    'auditor permission' => array(
      'title'       => t('注册用户借款审核员权限'),
      'description' => t('注册用户借款审核员：网站初级管理员，负责审核网站新注册用户资料、抵押借款申请资料、浏览用户资料、获取应付款账户（投资用户）及金额列表，获取应还款账户（借款用户）及金额列表，浏览抵押借款欠款用户及金额列表'),
    ),
  );
  */
}

/**
* Implementation of hook_menu().
*/
function mboryi_menu() {
  // api function calls 
  $items['hire_complaints'] = array(
    'title'           => t("包工举报"),
    'page callback'   => 'get_complaints', 
    'page arguments'  => array("1", "hire"),
    'access callback' => TRUE,
    'type'            => MENU_NORMAL_ITEM,
  );
  $items['hire_complaints/tocheck'] = array(
    'title'           => t("未处理"),
    'access callback' => TRUE,
    'type'            => MENU_DEFAULT_LOCAL_TASK,
    'weight'          => 0,
  );
  $items['hire_complaints/checking'] = array(
    'title'           => t("处理中"),
    'page callback'   => 'get_complaints', 
    'page arguments'  => array("2", "hire"),
    'access callback' => TRUE,
    'type'            => MENU_LOCAL_TASK,
    'weight'          => 5,
  );
  $items['hire_complaints/checked'] = array(
    'title'           => t("已处理"),
    'page callback'   => 'get_complaints', 
    'page arguments'  => array("3", "hire"),
    'access callback' => TRUE,
    'type'            => MENU_LOCAL_TASK,
    'weight'          => 10,
  );
  $items['api/get_hire_complaints'] = array(
    'page callback'   => 'get_hire_complaints', 
    'access callback' => TRUE,
    'type'            => MENU_NORMAL_ITEM,
    'file'            => 'api/get_hire_complaints.php',
  );
  $items['api/audit_hire_complaint'] = array(
    'page callback'   => 'audit_hire_complaint', 
    'access callback' => TRUE,
    'type'            => MENU_NORMAL_ITEM,
    'file'            => 'api/audit_hire_complaint.php',
  );

  $items['job_complaints'] = array(
    'title'           => t("招工举报"),
    'page callback'   => 'get_complaints', 
    'page arguments'  => array("1", "job"),
    'access callback' => TRUE,
    'type'            => MENU_NORMAL_ITEM, 
  );
  $items['job_complaints/tocheck'] = array(
    'title'           => t("未处理"),
    'access callback' => TRUE,
    'type'            => MENU_DEFAULT_LOCAL_TASK,
    'weight'          => 0,
  );
  $items['job_complaints/checking'] = array(
    'title'           => t("处理中"),
    'page callback'   => 'get_complaints', 
    'page arguments'  => array("2", "job"),
    'access callback' => TRUE,
    'type'            => MENU_LOCAL_TASK,
    'weight'          => 5,
  );
  $items['job_complaints/checked'] = array(
    'title'           => t("已处理"),
    'page callback'   => 'get_complaints', 
    'page arguments'  => array("3", "job"),
    'access callback' => TRUE,
    'type'            => MENU_LOCAL_TASK,
    'weight'          => 10,
  );
  $items['api/get_job_complaints'] = array(
    'page callback'   => 'get_job_complaints', 
    'access callback' => TRUE,
    'type'            => MENU_NORMAL_ITEM,
    'file'            => 'api/get_job_complaints.php',
  );
  $items['api/audit_job_complaint'] = array(
    'page callback'   => 'audit_job_complaint', 
    'access callback' => TRUE,
    'type'            => MENU_NORMAL_ITEM,
    'file'            => 'api/audit_job_complaint.php',
  );
  $items['sub_users'] = array(
    'title'           => t("订阅用户"),
    'page callback'   => 'list_users', 
    'page arguments'  => array("1"),
    'access callback' => TRUE,
    'type'            => MENU_NORMAL_ITEM,
    'weight'          => 10,
  );
  $items['online_users'] = array(
    'title'           => t("在线用户"),
    'page callback'   => 'list_users', 
    'page arguments'  => array("2"),
    'access callback' => TRUE,
    'type'            => MENU_NORMAL_ITEM,
    'weight'          => 20,
  );
  $items['search_users'] = array(
    'title'           => t("搜索用户"),
    'page callback'   => 'list_users', 
    'page arguments'  => array("3"),
    'access callback' => TRUE,
    'type'            => MENU_NORMAL_ITEM,
    'weight'          => 30,
  );
  return $items; 
} 

function get_complaints($type, $complaints_type){
  $content = array();
  $content['type'] = $type;
  $content['complaints_type'] = $complaints_type;
  return theme('complaints', $content);
}


// 订阅用户
// 在线用户
// 搜索用户
function list_users($type){
  $content = array();
  $content['type'] = $type;
  return theme('list_users', $content);
}

function mboryi_theme($existing, $type, $theme, $path) {  
  $p = drupal_get_path('module', 'mboryi') . '/tpl'; 

  return array(
    'complaints' => array(
        'path'      => $p,
        'template'  => 'complaints', 
      ),
    'list_users' => array(
        'path'      => $p,
        'template'  => 'list_users', 
      ),

    );
}